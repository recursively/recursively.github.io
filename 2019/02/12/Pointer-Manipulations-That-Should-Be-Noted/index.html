<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/hive-apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/hive-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/hive-16x16.png">
  <link rel="mask-icon" href="/images/hive.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"recursively.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="I summarized a few confusing usages of pointers in C and used some code from other guys as examples.">
<meta property="og:type" content="article">
<meta property="og:title" content="Pointer Manipulations That Should Be Noted">
<meta property="og:url" content="https://recursively.github.io/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/index.html">
<meta property="og:site_name" content="Mountaineer &amp; Hiker YHZ&#39;s Daily">
<meta property="og:description" content="I summarized a few confusing usages of pointers in C and used some code from other guys as examples.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://recursively.github.io/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/pic_1.png">
<meta property="og:image" content="https://recursively.github.io/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/pic_2.png">
<meta property="og:image" content="https://recursively.github.io/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/pic_3.png">
<meta property="article:published_time" content="2019-02-12T15:02:09.000Z">
<meta property="article:modified_time" content="2024-01-02T04:51:03.611Z">
<meta property="article:author" content="YHZ">
<meta property="article:tag" content="C&#x2F;C++">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://recursively.github.io/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/pic_1.png">

<link rel="canonical" href="https://recursively.github.io/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Pointer Manipulations That Should Be Noted | Mountaineer & Hiker YHZ's Daily</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130244347-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130244347-1');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c5a2712bf7c73d87374b33356ead82b0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Mountaineer & Hiker YHZ's Daily" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Mountaineer & Hiker YHZ's Daily</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">This is a personal blog along with other stuff.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-view">

    <a href="/globe/" rel="section"><i class="fa fa-eye fa-fw"></i>View</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/recursively" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://recursively.github.io/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hive.gif">
      <meta itemprop="name" content="YHZ">
      <meta itemprop="description" content="LEARNING, TRAVELING, ENJOYING">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mountaineer & Hiker YHZ's Daily">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Pointer Manipulations That Should Be Noted
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-02-12 15:02:09" itemprop="dateCreated datePublished" datetime="2019-02-12T15:02:09+00:00">2019-02-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-01-02 04:51:03" itemprop="dateModified" datetime="2024-01-02T04:51:03+00:00">2024-01-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
                </span>
            </span>

          
            <div class="post-description">I summarized a few confusing usages of pointers in C and used some code from other guys as examples.</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="Double-pointer"><a href="#Double-pointer" class="headerlink" title="Double pointer"></a>Double pointer</h2><p>Which means the pointer to pointer. Take a look at this program.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">GetMemory</span><span class="params">(<span class="type">char</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">   p = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Test</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *str = <span class="literal">NULL</span>;</span><br><span class="line">    GetMemory(str);</span><br><span class="line">    <span class="built_in">strcpy</span>(str, <span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If we directly test this program it will be aborted by throwing an exception. As we all know, the arguments are passed to functions by value in C/C++. So it’s clear that the pointer <em>str</em> passed into the function <em>GetMemory</em> is a copy of real <em>str</em>. We can fix this program by using a double pointer.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">GetMemory</span><span class="params">(<span class="type">char</span> **p)</span></span><br><span class="line">&#123;</span><br><span class="line">    *p = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Test</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *str = <span class="literal">NULL</span>;</span><br><span class="line">    GetMemory(&amp;str);</span><br><span class="line">    <span class="built_in">strcpy</span>(str, <span class="string">&quot;hello world\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(str);</span><br></pre></td></tr></table></figure>

<h2 id="Simplify-code-by-using-pointers"><a href="#Simplify-code-by-using-pointers" class="headerlink" title="Simplify code by using pointers"></a>Simplify code by using pointers</h2><p>Here gives an implement of linked list:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//节点</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">s_node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="comment">//关键字</span></span><br><span class="line">	<span class="type">int</span> key;</span><br><span class="line">	<span class="comment">//下一个节点指针</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">s_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; s_node;</span><br><span class="line"></span><br><span class="line"><span class="comment">//链表</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">s_list</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="comment">//头节点</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">s_node</span> *<span class="title">header</span>;</span></span><br><span class="line">&#125; s_list;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">list_insert</span><span class="params">(s_list *<span class="built_in">list</span>, <span class="type">int</span> key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">list</span> == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建新节点</span></span><br><span class="line">	s_node *n = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(s_node));</span><br><span class="line">	n-&gt;key = key;</span><br><span class="line">	n-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果链表头为空，表头即为新节点</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">list</span>-&gt;header == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">list</span>-&gt;header = n;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果关键字key小于链表头的key</span></span><br><span class="line">	<span class="keyword">if</span> (key &lt; <span class="built_in">list</span>-&gt;header-&gt;key)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//替换新节点为链表头，原表头变为新节点的next</span></span><br><span class="line">		n-&gt;next = <span class="built_in">list</span>-&gt;header;</span><br><span class="line">		<span class="built_in">list</span>-&gt;header = n;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//遍历链表，保持待比较节点的前一个节点</span></span><br><span class="line">	s_node *p = <span class="built_in">list</span>-&gt;header;</span><br><span class="line">	<span class="comment">//找到第一个大于新节点key的节点（注意，此时p其实是这个节点的上一个节点）</span></span><br><span class="line">	<span class="keyword">while</span> (p-&gt;next != <span class="literal">NULL</span> &amp;&amp; p-&gt;next-&gt;key &lt; key)</span><br><span class="line">	&#123;</span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//插入新节点</span></span><br><span class="line">	n-&gt;next = p-&gt;next;</span><br><span class="line">	p-&gt;next = n;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	s_list testlist;</span><br><span class="line">	list_insert(&amp;testlist, <span class="number">5</span>);</span><br><span class="line">	list_insert(&amp;testlist, <span class="number">8</span>);</span><br><span class="line">	list_insert(&amp;testlist, <span class="number">7</span>);</span><br><span class="line">	list_insert(&amp;testlist, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We must adjust the relations between members of the linked list properly without the help of pointer. This code can be much briefer in the pointer version.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//节点</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">s_node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="comment">//关键字</span></span><br><span class="line">	<span class="type">int</span> key;</span><br><span class="line">	<span class="comment">//下一个节点指针</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">s_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; s_node;</span><br><span class="line"></span><br><span class="line"><span class="comment">//链表</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">s_list</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="comment">//头节点</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">s_node</span> *<span class="title">header</span>;</span></span><br><span class="line">&#125; s_list;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">list_insert2</span><span class="params">(s_list *<span class="built_in">list</span>, <span class="type">int</span> key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">list</span> == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建新节点</span></span><br><span class="line">	s_node *n = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(s_node));</span><br><span class="line">	n-&gt;key = key;</span><br><span class="line">	n-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//二级指针</span></span><br><span class="line">	s_node **p = &amp;<span class="built_in">list</span>-&gt;header;</span><br><span class="line">	<span class="comment">//找到第一个大于key的节点</span></span><br><span class="line">	<span class="keyword">while</span> ((*p) != <span class="literal">NULL</span> &amp;&amp; (*p)-&gt;key &lt; key)</span><br><span class="line">	&#123;</span><br><span class="line">		p = &amp;(*p)-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//插入新节点</span></span><br><span class="line">	n-&gt;next = *p;</span><br><span class="line">	*p = n;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	s_list testlist;</span><br><span class="line">	list_insert2(&amp;testlist, <span class="number">5</span>);</span><br><span class="line">	list_insert2(&amp;testlist, <span class="number">8</span>);</span><br><span class="line">	list_insert2(&amp;testlist, <span class="number">7</span>);</span><br><span class="line">	list_insert2(&amp;testlist, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It can be clearer by giving a diagram:</p>
<img src="/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/pic_1.png" width="100%" height="100%">

<p>Those examples we saw above is easy to understand. Let’s dive in some instances which are a little bit confusing.</p>
<h2 id="When-to-pass-address"><a href="#When-to-pass-address" class="headerlink" title="When to pass address?"></a>When to pass address?</h2><p>Take a look at this code:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mcheck.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> false 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> true 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//结构体类型，每个导师有三个学生</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Tea</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">    <span class="type">char</span> *tName; <span class="comment">//导师名字，需要动态分配空间char *====&gt;char</span></span><br><span class="line">    <span class="type">char</span> **stu;  <span class="comment">//三个学生，需要动态分配空间，堆区数组</span></span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    &#125;Teacher;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在createTeacher中分配空间</span></span><br><span class="line"><span class="comment">//n1 =3; //导师个数</span></span><br><span class="line"><span class="comment">//n2 = 3 //学生</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">createTeacher</span><span class="params">(Teacher **p, <span class="type">int</span> n1, <span class="type">int</span> n2)</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> i,j,k;   <span class="comment">//分配3个Student信息</span></span><br><span class="line">    *p = (Teacher*)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(Teacher)*<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;n1;i++)  <span class="comment">//分配3个导师的地址空间</span></span><br><span class="line">        &#123;</span><br><span class="line">        (*p)[i].tName=(<span class="type">char</span> *)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">20</span>);  </span><br><span class="line">        <span class="keyword">if</span> ((*p)[i].tName == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">//(*p)-&gt;stu=(char **)malloc (sizeof(char*)*3);</span></span><br><span class="line">    <span class="keyword">for</span> (j=<span class="number">0</span>;j&lt;n2;j++)</span><br><span class="line">        &#123;</span><br><span class="line">         (*p)[j].stu=(<span class="type">char</span> **)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(<span class="type">char</span>*)*<span class="number">3</span>);</span><br><span class="line">         <span class="keyword">if</span> ((*p)[j].stu == <span class="literal">NULL</span>)</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">for</span> (k=<span class="number">0</span>;k&lt;<span class="number">3</span>;k++)</span><br><span class="line">         &#123;</span><br><span class="line">         (*p)[j].stu[k]=(<span class="type">char</span> *)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">20</span>);</span><br><span class="line">         <span class="keyword">if</span> ((*p)[j].stu[k] == <span class="literal">NULL</span>)</span><br><span class="line">             &#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给成员赋值</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">initTeacher</span><span class="params">(Teacher *p, <span class="type">int</span> n1, <span class="type">int</span> n2)</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> i,j,k=<span class="number">0</span>;  <span class="comment">//</span></span><br><span class="line">      <span class="keyword">if</span> (p == <span class="literal">NULL</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">&quot;error\n&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//n1 =3; //导师个数</span></span><br><span class="line">      <span class="comment">//n2 = 3 //学生</span></span><br><span class="line">     <span class="built_in">puts</span> (<span class="string">&quot;-----导师赋值------&quot;</span>);</span><br><span class="line">     <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;n1;i++)</span><br><span class="line">     &#123;</span><br><span class="line">        <span class="type">char</span> *buf[]=&#123;<span class="string">&quot;王教授&quot;</span>,<span class="string">&quot;陆教授&quot;</span>,<span class="string">&quot;田导师&quot;</span>&#125;;</span><br><span class="line">        p[i].age=<span class="number">22</span>+i;</span><br><span class="line">        <span class="comment">//printf (&quot;%d&quot;,p[i].age);</span></span><br><span class="line">        <span class="built_in">strcpy</span> (p[i].tName,buf[i]);</span><br><span class="line">    <span class="comment">//  printf (&quot;%s&quot;,p[i].tName);</span></span><br><span class="line">        <span class="keyword">for</span> (j=<span class="number">0</span>;j&lt;n2;j++)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          <span class="type">char</span> *arr[]=&#123;<span class="string">&quot;小黎&quot;</span>,<span class="string">&quot;小田&quot;</span>,<span class="string">&quot;小张&quot;</span>,<span class="string">&quot;小王&quot;</span>,<span class="string">&quot;小胡&quot;</span>,<span class="string">&quot;小范&quot;</span>,</span><br><span class="line">              <span class="string">&quot;小杨&quot;</span>,<span class="string">&quot;小石&quot;</span>,<span class="string">&quot;小柯&quot;</span>&#125;;</span><br><span class="line">          <span class="built_in">strcpy</span> (p[i].stu[j],arr[k]);</span><br><span class="line">          ++k;</span><br><span class="line">        <span class="comment">//  printf (&quot;%s\n&quot;,p[i].stu[j]);</span></span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印结构体成员信息</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">printTeacher</span><span class="params">(Teacher *p, <span class="type">int</span> n1, <span class="type">int</span> n2)</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> i,j;</span><br><span class="line">      <span class="keyword">if</span> (p == <span class="literal">NULL</span>)</span><br><span class="line">      &#123;</span><br><span class="line">       <span class="built_in">printf</span> (<span class="string">&quot;error\n&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;n1;i++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">&quot;\t\t%s\n&quot;</span>,p[i].tName);  <span class="comment">//导师</span></span><br><span class="line">        <span class="keyword">for</span> (j=<span class="number">0</span>;j&lt;n2;j++)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="built_in">printf</span> (<span class="string">&quot;\t%s&quot;</span>,p[i].stu[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">&quot;\t\t%d\n\n&quot;</span>,p[i].age);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//释放空间，在函数内部把p赋值为NULL</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">freeTeacher</span><span class="params">(Teacher **p, <span class="type">int</span> n1, <span class="type">int</span> n2)</span></span><br><span class="line">    &#123;</span><br><span class="line">       <span class="type">int</span> i,j;</span><br><span class="line">       <span class="keyword">if</span> (p == <span class="literal">NULL</span>)</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="built_in">printf</span> (<span class="string">&quot;Empty\n&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">           &#123;</span><br><span class="line">              <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;n1;i++)</span><br><span class="line">              &#123;</span><br><span class="line">                 <span class="keyword">for</span> (j=<span class="number">0</span>;j&lt;n2;j++)</span><br><span class="line">                 &#123;</span><br><span class="line">                   <span class="keyword">if</span> ((*p)[i].stu[j]!=<span class="literal">NULL</span>)</span><br><span class="line">                   &#123;</span><br><span class="line">                     <span class="built_in">free</span> ((*p)[i].stu[j]);</span><br><span class="line">                     (*p)[i].stu[j]=<span class="literal">NULL</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">if</span> ((*p)[i].stu!= <span class="literal">NULL</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                   <span class="built_in">free</span> ((*p)[i].stu);</span><br><span class="line">                   (*p)[i].stu=<span class="literal">NULL</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="built_in">free</span> ((*p)[i].tName);</span><br><span class="line">                 (*p)[i].tName=<span class="literal">NULL</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="built_in">free</span> (*p);</span><br><span class="line">              *p=<span class="literal">NULL</span>;</span><br><span class="line">           &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> n1 = <span class="number">3</span>; <span class="comment">//导师个数</span></span><br><span class="line">    <span class="type">int</span> n2 = <span class="number">3</span>; <span class="comment">//学生</span></span><br><span class="line">    Teacher *p = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    setenv(<span class="string">&quot;MALLOC_TRACE&quot;</span>,<span class="string">&quot;1.txt&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    mtrace();</span><br><span class="line"></span><br><span class="line">    ret = createTeacher(&amp;p, n1, n2);</span><br><span class="line">    <span class="keyword">if</span> (ret == <span class="literal">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;createTeacher err:%d\n&quot;</span>, ret);</span><br><span class="line">        <span class="built_in">exit</span> (EXIT_FAILURE);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    initTeacher(p, n1, n2); <span class="comment">//给成员赋值</span></span><br><span class="line">    printTeacher(p, n1, n2);</span><br><span class="line">    <span class="comment">//释放空间，在函数内部把p赋值为NULL</span></span><br><span class="line">    freeTeacher(&amp;p, n1, n2);</span><br><span class="line">    <span class="comment">// muntrace();</span></span><br><span class="line">    <span class="comment">// system(&quot;pause&quot;);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>I paste the code of function <em>createTeacher2</em> below and here comes the question, can we just simply replace the function <em>createTeacher</em> to <em>createTeacher2</em>?</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">createTeacher2</span><span class="params">(Teacher *p, <span class="type">int</span> n1, <span class="type">int</span> n2)</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> i,j,k;   <span class="comment">//分配3个Student信息</span></span><br><span class="line">    p = (Teacher*)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(Teacher)*<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;n1;i++)  <span class="comment">//分配3个导师的地址空间</span></span><br><span class="line">        &#123;</span><br><span class="line">        (p)[i].tName=(<span class="type">char</span> *)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">20</span>);  </span><br><span class="line">        <span class="keyword">if</span> ((p)[i].tName == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">//(*p)-&gt;stu=(char **)malloc (sizeof(char*)*3);</span></span><br><span class="line">    <span class="keyword">for</span> (j=<span class="number">0</span>;j&lt;n2;j++)</span><br><span class="line">        &#123;</span><br><span class="line">         (p)[j].stu=(<span class="type">char</span> **)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">3</span>); </span><br><span class="line">         <span class="keyword">if</span> ((p)[j].stu == <span class="literal">NULL</span>)</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">for</span> (k=<span class="number">0</span>;k&lt;<span class="number">3</span>;k++)</span><br><span class="line">         &#123;</span><br><span class="line">         (p)[j].stu[k]=(<span class="type">char</span> *)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">20</span>);</span><br><span class="line">         <span class="keyword">if</span> ((p)[j].stu[k] == <span class="literal">NULL</span>)</span><br><span class="line">             &#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>Modify the code in <em>main()</em>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret = createTeacher2(p, n1, n2);</span><br></pre></td></tr></table></figure>
<p>This code can be correctly compiled and if we run the program we will get stuck in the step of <em>initTeacher</em>. Because the pointer <em>p</em> passed to <em>createTeacher2</em> wasn’t allocated memory due to the pass-by-value feature. In other words, the pointer <em>p</em> in the <em>main()</em> block will always point to NULL. </p>
<img src="/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/pic_2.png" width="100%" height="100%">

<p>To fix it, we should use the double pointer to pass the address of pointer <em>p</em>.</p>
<p>There is another example we should take care of. Here is an implement of a binary search tree.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//binarysearchtree.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __BINARY_SEARCH_TREE__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __BINARY_SEARCH_TREE__</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> mytype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">bstree_node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	mytype data;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">bstree_node</span> *<span class="title">lchild</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">bstree_node</span> *<span class="title">rchild</span>;</span></span><br><span class="line">&#125;bstree_node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">bstree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    <span class="type">int</span> (*compare)(mytype key1,mytype key2);</span><br><span class="line">	<span class="type">int</span> (*destory)(mytype data);</span><br><span class="line">	bstree_node *root;</span><br><span class="line">&#125;bstree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">int</span> <span class="params">(*compare_fuc)</span><span class="params">(mytype key1,mytype key2)</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">int</span> <span class="params">(*destory_fuc)</span><span class="params">(mytype data)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> bstree_is_empty(tree)  (tree-&gt;size == 0)</span></span><br><span class="line"></span><br><span class="line">bstree *<span class="title function_">bstree_create</span><span class="params">(compare_fuc compare,destory_fuc destory)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//binarysearchtree.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;binarysearchtree.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">bstree *<span class="title function_">bstree_create</span><span class="params">(compare_fuc compare,destory_fuc destory)</span></span><br><span class="line">&#123;</span><br><span class="line">	bstree *tree = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	tree = (bstree*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(bstree));</span><br><span class="line">	<span class="keyword">if</span> (tree == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tree-&gt;size = <span class="number">0</span>;</span><br><span class="line">    tree-&gt;compare = compare;</span><br><span class="line">    tree-&gt;destory = destory;</span><br><span class="line">	tree-&gt;root = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bstree_node *<span class="title function_">bstree_search</span><span class="params">(bstree *tree,mytype data)</span></span><br><span class="line">&#123;</span><br><span class="line">	bstree_node *node = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((tree == <span class="literal">NULL</span>) || (bstree_is_empty(tree)))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    node = tree-&gt;root;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(node != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		res = tree-&gt;compare(data,node-&gt;data);</span><br><span class="line">		<span class="keyword">if</span>(res == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> node;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (res &gt; <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			node = node-&gt;rchild;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			node = node-&gt;lchild;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">   </span><br><span class="line">	<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">bstree_insert</span><span class="params">(bstree * tree, mytype data)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;second ptr address: %p&quot;</span>, &amp;tree);</span><br><span class="line">    bstree_node *node = <span class="literal">NULL</span>;</span><br><span class="line">    bstree_node *tmp = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (tree == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	node = (bstree_node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(bstree_node));</span><br><span class="line">	<span class="keyword">if</span> (node == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	node-&gt;data = data;</span><br><span class="line">	node-&gt;lchild = <span class="literal">NULL</span>;</span><br><span class="line">	node-&gt;rchild = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*如果二叉树为空，直接挂到根节点*/</span></span><br><span class="line">	<span class="keyword">if</span> (bstree_is_empty(tree))</span><br><span class="line">	&#123;</span><br><span class="line">        tree-&gt;root = node;</span><br><span class="line">		tree-&gt;size++;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tmp = tree-&gt;root;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(tmp != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		res = tree-&gt;compare(data,tmp-&gt;data);</span><br><span class="line">		<span class="keyword">if</span> (res &gt; <span class="number">0</span>) <span class="comment">/*去右孩子查找*/</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (tmp-&gt;rchild == <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				tmp-&gt;rchild = node;</span><br><span class="line">				tree-&gt;size++;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		    tmp = tmp-&gt;rchild;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="comment">/*去左孩子查找*/</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(tmp-&gt;lchild == <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				tmp-&gt;lchild = node;</span><br><span class="line">				tree-&gt;size++;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			tmp = tmp-&gt;lchild;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">return</span> <span class="number">-3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">bstree_delete</span><span class="params">(bstree *tree,mytype data)</span></span><br><span class="line">&#123;</span><br><span class="line">	bstree_node *node = <span class="literal">NULL</span>;<span class="comment">/*要删除的节点*/</span></span><br><span class="line">	bstree_node *pnode = <span class="literal">NULL</span>;<span class="comment">/*要删除节点的父节点*/</span></span><br><span class="line">	bstree_node *minnode = <span class="literal">NULL</span>;<span class="comment">/*要删除节点的父节点*/</span></span><br><span class="line">	bstree_node *pminnode = <span class="literal">NULL</span>;<span class="comment">/*要删除节点的父节点*/</span></span><br><span class="line">    mytype tmp = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((tree == <span class="literal">NULL</span>) || (bstree_is_empty(tree)))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	node = tree-&gt;root;</span><br><span class="line">	<span class="keyword">while</span> ((node != <span class="literal">NULL</span>) &amp;&amp; ((res = tree-&gt;compare(data,node-&gt;data)) != <span class="number">0</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		pnode = node;</span><br><span class="line">		<span class="keyword">if</span>(res &gt; <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">            node = node-&gt;rchild;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">            node = node-&gt;lchild;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*说明要删除的节点不存在*/</span></span><br><span class="line">	<span class="keyword">if</span> (node == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*1、如果要删除node有2个子节点，需要找到右子树的最小节点minnode，</span></span><br><span class="line"><span class="comment">	 * 更新minnode和node节点数据，这样minnode节点就是要删除的节点</span></span><br><span class="line"><span class="comment">	 * 再更新node和pnode节点指向要删除的节点*/</span></span><br><span class="line">	<span class="keyword">if</span> ((node-&gt;lchild != <span class="literal">NULL</span>) &amp;&amp; (node-&gt;rchild != <span class="literal">NULL</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		minnode = node-&gt;rchild;</span><br><span class="line">		pminnode = node;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(minnode-&gt;lchild != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			pminnode = minnode;</span><br><span class="line">			minnode = minnode-&gt;lchild;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/*node 节点和minnode节点数据互换*/</span></span><br><span class="line">        tmp = node-&gt;data;</span><br><span class="line">		node-&gt;data = minnode-&gt;data;</span><br><span class="line">		minnode-&gt;data = tmp;</span><br><span class="line">		<span class="comment">/*更新要删除的节点和其父节点*/</span></span><br><span class="line">		node = minnode;</span><br><span class="line">		pnode = pminnode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*2、当前要删除的节点只有左孩子或者右孩子时，直接父节点的直向删除的节点*/</span></span><br><span class="line">	<span class="keyword">if</span> (node-&gt;lchild != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">        minnode = node-&gt;lchild;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (node-&gt;rchild != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		minnode = node-&gt;rchild;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		minnode = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (pnode == <span class="literal">NULL</span>)<span class="comment">/*当要删除的时根节点时,*/</span></span><br><span class="line">	&#123;</span><br><span class="line">		tree-&gt;root = minnode;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (pnode-&gt;lchild == node)</span><br><span class="line">	&#123;</span><br><span class="line">		pnode-&gt;lchild = minnode;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		pnode-&gt;rchild = minnode;</span><br><span class="line">	&#125;</span><br><span class="line">    tree-&gt;size--;</span><br><span class="line">	<span class="built_in">free</span> (node);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*采用递归方式删除节点*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bstree_destory_node</span><span class="params">(bstree *tree,bstree_node *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	bstree_destory_node(tree,root-&gt;lchild);</span><br><span class="line">	bstree_destory_node(tree,root-&gt;rchild);</span><br><span class="line">	<span class="built_in">free</span>(root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*二叉搜索树销毁*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bstree_destory</span><span class="params">(bstree *tree)</span></span><br><span class="line">&#123;</span><br><span class="line">	bstree_destory_node(tree,tree-&gt;root);</span><br><span class="line">	<span class="built_in">free</span>(tree);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*中序遍历打印树节点*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bstree_inorder_node</span><span class="params">(bstree_node *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	bstree_node *node = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	bstree_inorder_node(root-&gt;lchild);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; %d &quot;</span>,root-&gt;data);</span><br><span class="line">	bstree_inorder_node(root-&gt;rchild);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">bstree_dump</span><span class="params">(bstree *tree)</span></span><br><span class="line">&#123;</span><br><span class="line">	bstree_node *node = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span> ((tree == <span class="literal">NULL</span>) || (bstree_is_empty(tree)))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n 当前树是空树&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\nSTART-----------------%d------------\r\n&quot;</span>,tree-&gt;size);</span><br><span class="line">	bstree_inorder_node(tree-&gt;root);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\nEND---------------------------------&quot;</span>,tree-&gt;size);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">bstree_compare</span><span class="params">(mytype key1,mytype key2)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (key1 == key2)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (key1 &gt; key2)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	bstree *tree = <span class="literal">NULL</span>;</span><br><span class="line">	bstree_node *node = <span class="literal">NULL</span>;</span><br><span class="line">	mytype data = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	setenv(<span class="string">&quot;MALLOC_TRACE&quot;</span>,<span class="string">&quot;1.txt&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    mtrace();</span><br><span class="line"></span><br><span class="line">	tree = bstree_create(bstree_compare,<span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;first address: %d&quot;</span>, tree);</span><br><span class="line">	assert(tree != <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n插入一个数字，输入100时退出：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;data);</span><br><span class="line">		<span class="keyword">if</span>(data == <span class="number">100</span>)<span class="keyword">break</span>;</span><br><span class="line">		res = bstree_insert(tree,data);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n %d 插入%s成功&quot;</span>,data,(res != <span class="number">0</span>)?(<span class="string">&quot;不&quot;</span>):(<span class="string">&quot; &quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	bstree_dump(tree);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n查询一个数字，输入100时退出：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;data);</span><br><span class="line">		<span class="keyword">if</span>(data == <span class="number">100</span>)<span class="keyword">break</span>;</span><br><span class="line">		node = bstree_search(tree,data);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n %d %s存在树中&quot;</span>,data,(node == <span class="literal">NULL</span>)?(<span class="string">&quot;不&quot;</span>):(<span class="string">&quot; &quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	bstree_dump(tree);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n删除一个数字，输入100时退出：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;data);</span><br><span class="line">		<span class="keyword">if</span>(data == <span class="number">100</span>)<span class="keyword">break</span>;</span><br><span class="line">		res = bstree_delete(tree,data);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n %d 删除%s成功&quot;</span>,data,(res != <span class="number">0</span>)?(<span class="string">&quot;不&quot;</span>):(<span class="string">&quot; &quot;</span>));</span><br><span class="line">	    bstree_dump(tree);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	bstree_destory(tree);</span><br><span class="line"></span><br><span class="line">    muntrace();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now let’s focus on the first while loop among the <em>main()</em> block. In this case, the pointer <em>tree</em> was directly passed into the function <em>bstree_insert</em>, it’s kind of odd compared with the previous instances. The difference is that the pointer <em>tree</em> has been allocated memory before passed as an argument. </p>
<img src="/2019/02/12/Pointer-Manipulations-That-Should-Be-Noted/pic_3.png" width="100%" height="100%">

<p>There are actually two pointers which belong to two different address in the memory, but both of them point to the same space. If we change the value of the space one pointer points to, we simultaneously change the value that the other pointer points to. If the extreme performance is what you want, The function <em>bstree_insert</em> can be correctly replaced by <em>bstree_insert2</em> as below. This conversion can save the time of memory allocation.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">bstree_insert2</span><span class="params">(bstree ** tree, mytype data)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;second address: %d&quot;</span>, *tree);</span><br><span class="line">    bstree_node *node = <span class="literal">NULL</span>;</span><br><span class="line">    bstree_node *tmp = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (tree == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	node = (bstree_node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(bstree_node));</span><br><span class="line">	<span class="keyword">if</span> (node == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	node-&gt;data = data;</span><br><span class="line">	node-&gt;lchild = <span class="literal">NULL</span>;</span><br><span class="line">	node-&gt;rchild = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*如果二叉树为空，直接挂到根节点*/</span></span><br><span class="line">	<span class="keyword">if</span> (bstree_is_empty((*tree)))</span><br><span class="line">	&#123;</span><br><span class="line">        (*tree)-&gt;root = node;</span><br><span class="line">		(*tree)-&gt;size++;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tmp = (*tree)-&gt;root;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(tmp != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		res = (*tree)-&gt;compare(data,tmp-&gt;data);</span><br><span class="line">		<span class="keyword">if</span> (res &gt; <span class="number">0</span>) <span class="comment">/*去右孩子查找*/</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (tmp-&gt;rchild == <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				tmp-&gt;rchild = node;</span><br><span class="line">				(*tree)-&gt;size++;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		    tmp = tmp-&gt;rchild;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="comment">/*去左孩子查找*/</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(tmp-&gt;lchild == <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				tmp-&gt;lchild = node;</span><br><span class="line">				(*tree)-&gt;size++;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			tmp = tmp-&gt;lchild;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">return</span> <span class="number">-3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then modify the <em>main()</em> code:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res = bstree_insert2(&amp;tree,data);</span><br></pre></td></tr></table></figure>
<p>One last instance that we should focus on, there is an implement of a binary tree:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//binarytree.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;list_queue.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">treenode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="type">int</span> data;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">treenode</span> *<span class="title">lchild</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">treenode</span> *<span class="title">rchild</span>;</span></span><br><span class="line">&#125;Tnode,Tree;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">binarytree_create</span><span class="params">(Tree **Root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n输入节点数值((当输入为100时，当前节点创建完成))):&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (a == <span class="number">100</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		*Root = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		*Root = (Tnode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Tnode));</span><br><span class="line">		<span class="keyword">if</span> (*Root == <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		(*Root)-&gt;data = a;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n create %d 的左孩子:&quot;</span>,a);</span><br><span class="line">		binarytree_create(&amp;((*Root)-&gt;lchild));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n create %d 的右孩子:&quot;</span>,a);</span><br><span class="line">		binarytree_create(&amp;((*Root)-&gt;rchild));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">binarytree_destory</span><span class="params">(Tree *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	binarytree_destory(root-&gt;lchild);</span><br><span class="line">	binarytree_destory(root-&gt;rchild);</span><br><span class="line">	<span class="built_in">free</span>(root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*先序遍历:根结点--》左子树---》右子树*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">binarytree_preorder</span><span class="params">(Tree *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; %d &quot;</span>,root-&gt;data);</span><br><span class="line">	binarytree_preorder(root-&gt;lchild);</span><br><span class="line">	binarytree_preorder(root-&gt;rchild);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*中序遍历:左子树--》跟节点---》右子树*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">binarytree_inorder</span><span class="params">(Tree *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	binarytree_inorder(root-&gt;lchild);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; %d &quot;</span>,root-&gt;data);</span><br><span class="line">	binarytree_inorder(root-&gt;rchild);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*后序遍历:左子树---》右子树-》根节点*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">binarytree_postorder</span><span class="params">(Tree *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	binarytree_postorder(root-&gt;lchild);</span><br><span class="line">	binarytree_postorder(root-&gt;rchild);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; %d &quot;</span>,root-&gt;data);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">binarytree_levelorder</span><span class="params">(Tree * root)</span></span><br><span class="line">&#123;</span><br><span class="line">	list_queue *<span class="built_in">queue</span> = <span class="literal">NULL</span>;</span><br><span class="line">	Tnode * node = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">queue</span> = list_queue_create();</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*根节点先入队*/</span></span><br><span class="line">	list_queue_enqueue(<span class="built_in">queue</span>,(<span class="type">void</span> *)root);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(!list_queue_is_empty(<span class="built_in">queue</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		list_queue_dequeue(<span class="built_in">queue</span>,(<span class="type">void</span> *)&amp;node);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot; %d &quot;</span>,node-&gt;data);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(node-&gt;lchild != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			list_queue_enqueue(<span class="built_in">queue</span>,(<span class="type">void</span> *)node-&gt;lchild);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(node-&gt;rchild != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			list_queue_enqueue(<span class="built_in">queue</span>,(<span class="type">void</span> *)node-&gt;rchild);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">free</span>(<span class="built_in">queue</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*打印叶子节点*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">binarytree_printfleaf</span><span class="params">(Tree *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((root-&gt;lchild == <span class="literal">NULL</span>) &amp;&amp; (root-&gt;rchild == <span class="literal">NULL</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot; %d &quot;</span>,root-&gt;data);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		binarytree_printfleaf(root-&gt;lchild);</span><br><span class="line">		binarytree_printfleaf(root-&gt;rchild);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*打印叶子的个数*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarytree_getleafnum</span><span class="params">(Tree*root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((root-&gt;lchild == <span class="literal">NULL</span>) &amp;&amp; (root-&gt;rchild == <span class="literal">NULL</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> binarytree_getleafnum(root-&gt;lchild) + binarytree_getleafnum(root-&gt;rchild);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*打印数的高度*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarytree_gethigh</span><span class="params">(Tree *root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> lhigh = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> rhigh = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	lhigh = binarytree_gethigh(root-&gt;lchild);</span><br><span class="line">	rhigh = binarytree_gethigh(root-&gt;rchild);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ((lhigh &gt; rhigh)?(lhigh + <span class="number">1</span>):(rhigh + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	Tree *root = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	setenv(<span class="string">&quot;MALLOC_TRACE&quot;</span>,<span class="string">&quot;1.txt&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    mtrace();</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n创建二叉树:&quot;</span>);</span><br><span class="line">	binarytree_create(&amp;root);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n先序遍历二叉树:&quot;</span>);</span><br><span class="line">	binarytree_preorder(root);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n中序遍历二叉树:&quot;</span>);</span><br><span class="line">	binarytree_inorder(root);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n后序遍历二叉树:&quot;</span>);</span><br><span class="line">	binarytree_postorder(root);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n层次遍历二叉树:&quot;</span>);</span><br><span class="line">	binarytree_levelorder(root);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n打印二叉树叶子节点:&quot;</span>);</span><br><span class="line">	binarytree_printfleaf(root);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n打印二叉树叶子节点个数:%d&quot;</span>,binarytree_getleafnum(root));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n打印二叉树高度:%d&quot;</span>,binarytree_gethigh(root));</span><br><span class="line"></span><br><span class="line">	binarytree_destory(root);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//list_queue.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> LINK_LIST_QUEUE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LINK_LIST_QUEUE_H</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">list_queue_node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="type">void</span> *data;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">list_queue_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;queue_node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">list_queue</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="type">int</span> num;</span><br><span class="line">	queue_node *head;</span><br><span class="line">	queue_node *tail;</span><br><span class="line">&#125;list_queue;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> list_queue_is_empty(queue) ((queue-&gt;num) == 0)</span></span><br><span class="line">list_queue *<span class="title function_">list_queue_create</span><span class="params">()</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">list_queue_enqueue</span><span class="params">(list_queue *<span class="built_in">queue</span>,<span class="type">void</span> *data)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">list_queue_dequeue</span><span class="params">(list_queue *<span class="built_in">queue</span>,<span class="type">void</span> **data)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//list_queue.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;./list_queue.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*创建队列头*/</span></span><br><span class="line">list_queue *<span class="title function_">list_queue_create</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	list_queue * <span class="built_in">queue</span> = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">queue</span> = (list_queue *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(list_queue));</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">queue</span> == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">queue</span>-&gt;num  = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">queue</span>-&gt;head = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="built_in">queue</span>-&gt;tail = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">queue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">list_queue_enqueue</span><span class="params">(list_queue *<span class="built_in">queue</span>,<span class="type">void</span> *data)</span></span><br><span class="line">&#123;</span><br><span class="line">	queue_node *ptmp = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">queue</span> == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ptmp = (queue_node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(queue_node));</span><br><span class="line">	<span class="keyword">if</span> (ptmp == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ptmp-&gt;data = data;</span><br><span class="line">	ptmp-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">queue</span>-&gt;head == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">queue</span>-&gt;head = ptmp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="built_in">queue</span>-&gt;tail-&gt;next = ptmp;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">queue</span>-&gt;tail = ptmp;</span><br><span class="line">	<span class="built_in">queue</span>-&gt;num++;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*出队*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">list_queue_dequeue</span><span class="params">(list_queue *<span class="built_in">queue</span>,<span class="type">void</span> **data)</span></span><br><span class="line">&#123;</span><br><span class="line">	queue_node * ptmp = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((<span class="built_in">queue</span> == <span class="literal">NULL</span>) || (data == <span class="literal">NULL</span>) || list_queue_is_empty(<span class="built_in">queue</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	*data = <span class="built_in">queue</span>-&gt;head-&gt;data;</span><br><span class="line">    ptmp = <span class="built_in">queue</span>-&gt;head;</span><br><span class="line">	<span class="built_in">queue</span>-&gt;head = <span class="built_in">queue</span>-&gt;head-&gt;next;</span><br><span class="line">	<span class="built_in">queue</span>-&gt;num--;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">queue</span>-&gt;head == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">queue</span>-&gt;tail = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">free</span>(ptmp);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Let’s review the code of <em>binarytree.c</em> and replace the function <em>binarytree_create</em> by <em>binarytree_create2</em>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">binarytree_create2</span><span class="params">(Tree *Root)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n输入节点数值((当输入为100时，当前节点创建完成))):&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (a == <span class="number">100</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Root = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		Root = (Tnode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Tnode));</span><br><span class="line">		<span class="keyword">if</span> (Root == <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Root-&gt;data = a;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n create %d 的左孩子:&quot;</span>,a);</span><br><span class="line">		binarytree_create(Root-&gt;lchild);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\r\n create %d 的右孩子:&quot;</span>,a);</span><br><span class="line">		binarytree_create(Root-&gt;rchild);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binarytree_create(root);</span><br></pre></td></tr></table></figure>
<p>Is that right? definitely not. The code can be surely compiled successfully, but the procedure will stop at function <em>binarytree_preorder</em>. Remember? The pointer cannot be directly passed as an argument if there will be memory allocation to the pointer later. the original pointer will always stay NULL. In addition, remember to free memory in each example to avoid memory leaks if I didn’t do that.</p>

    </div>

    
    
    
        

  <div class="followme">
    <p>Welcome to my other publishing channels</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/EVE_RWISE">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/C-C/" rel="tag"># C/C++</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/01/11/Devices-For-Badusb-And-Badpowerbank/" rel="prev" title="Devices For Badusb And Badpowerbank">
      <i class="fa fa-chevron-left"></i> Devices For Badusb And Badpowerbank
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/04/11/Get-Network-Traffic-of-Mobile-APPs/" rel="next" title="Get Network Traffic of Mobile APPs">
      Get Network Traffic of Mobile APPs <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Double-pointer"><span class="nav-number">1.</span> <span class="nav-text">Double pointer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Simplify-code-by-using-pointers"><span class="nav-number">2.</span> <span class="nav-text">Simplify code by using pointers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#When-to-pass-address"><span class="nav-number">3.</span> <span class="nav-text">When to pass address?</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="YHZ"
      src="/images/hive.gif">
  <p class="site-author-name" itemprop="name">YHZ</p>
  <div class="site-description" itemprop="description">LEARNING, TRAVELING, ENJOYING</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:recursively.z@gmail.com" title="E-Mail → mailto:recursively.z@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://t.me/EVE_RWISE" title="Telegram → https:&#x2F;&#x2F;t.me&#x2F;EVE_RWISE" rel="noopener" target="_blank"><i class="fab fa-telegram fa-fw"></i>Telegram</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YHZ</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js"></script>
    <script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_lines.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '95efdfd7fd6efa56b483',
      clientSecret: '48c6d4d52267d502c9449ed5148fc5102df12362',
      repo        : 'recursively.github.io',
      owner       : 'recursively',
      admin       : ['recursively'],
      id          : '70b2bb009ef0f5c41da8e7091ef466e5',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
